package com.qihancloud;import com.common.ByteUtil;import com.common.Common;import com.factory.MsgFactory;import com.msg.Msg;import com.msg.MsgHeader;public class KeepHeart implements Runnable {	public int user_id;	Msg msg;	boolean heartBeating = true;	long mark = 0;	public KeepHeart(Msg msg) {		this.msg = msg;		this.user_id = msg.qiHanServer.srcUid;	}	/**	 * ·¢ËÍÐÄÌø°ü	 */	private void client_greeting() {		MsgHeader client_greeting = MsgFactory.setMsgHeader();		client_greeting.setCommand(3001);		client_greeting.setSrc_user_id(user_id);		byte[] client_greeting_bytes = MsgFactory.toByteArray(client_greeting);		byte[] greeting_msg = new byte[72 + 4];		byte[] greeting_len_bytes = ByteUtil.IntTobyte4(72);		System.arraycopy(greeting_len_bytes, 0, greeting_msg, 0, greeting_len_bytes.length);		System.arraycopy(client_greeting_bytes, 0, greeting_msg, greeting_len_bytes.length,				client_greeting_bytes.length);		msg.sendMsg(greeting_msg);	}	@Override	public void run() {		while (this.heartBeating) {			if (mark % 50 == 0) {				client_greeting();			}			if (!heartBeating) {				break;			}			Common.sleepTime(100);			mark += 1;		}	}	public void stop(){		this.heartBeating=false;	}}